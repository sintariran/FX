# PKGの再計算・書き換えガイド

FXシステムにおけるPKGの再計算と書き換え手順（取得データ/PKGの再計算・書き換えについて.xlsxより）

## 事前説明

### PKGの再計算について

**概要**
- PKGは基本的に構成条件に変更があったときに計算をするが、それまでは計算をしないことで全体の計算速度を早くしている
- PKG再計算は特定のPKGを構成条件に変更がある無しに関わらず再計算すること

**目的**
- リアルでの計算時、構成要素に変化があって構成条件が満たされる(満たされなくなる)にも関わらず、PKGが成立(非成立)になることがある
- それを再計算することで解消することが目的

### PKGの書換について

**概要**
- PKGの計算結果に関わらず、出力を特定の値に書き換える

**目的**
- 基本的には再計算と同じ
- 指標によっては書き換えの方がいい場合がある

## 1. 再計算の手順

1. リアル監視のエクセルの「関連パッケージ探索」のシートを開く
2. 5行目以下、ルートIDが載っている部分をクリアする
3. 関連PKGの文字のあるセルの真下から再計算したいPKGを貼り付ける
4. 関連探索ボタンを押す
5. 計算が始まることを確認する
6. 計算がゆっくりしだしたら、escキーで中止する
7. 親階層列にルートIDが出力されることを確認する
8. ルートIDの191部分とルートID部分を分離する
9. hostosrdフォルダを開く
10. forced-settingフォルダを開く
11. changeフォルダを開く
12. changelistset_file1.csvがあることを確認する
13. 12のcsvを開く
14. 8で作ったデータを13のcsvに貼り付けて保存する
15. 14で保存したcsvを2個複製する
16. 複製したファイル名をfile2、file3に書き換える
17. changelistset_file1～3の3つのファイルをコピーする
18. 同フォルダ内にある「1」「2」のフォルダの内、「2」を開く
19. 「already」「cash」フォルダがあることを確認する
20. 「already」「cash」フォルダ内『ではなく』、同階層にコピーしたファイルを貼り付ける
21. 「cash」フォルダ内のcsvの更新時刻が変わったら再計算手続きの完了

## 2. 書換の手順

### フォルダの説明

1. hostosrdフォルダを開く
2. forced-settingフォルダを開く
3. pkgsetフォルダを開く
4. after、before、restartの3つのフォルダがある
   - **after**: PKG計算をしようをする後に値を上書する
   - **before**: PKG計算をしようをする前に値を上書する
   - **restart**: 触らないこと！

### 手順

1. afterまたはbeforeファイル内のpkgset_file1.csvを使用する
2. ルートID部分に上書したいルートIDを入力する
3. HoldRowには何も入力しない
4. Valueには出力したい値を入力する
5. Now0/Pre1には0か1を入力する
   - 0: 今の時刻
   - 1: 前の時刻
   - ※両方変更したい場合は、同じルートIDを2行入力して、片方を0、もう片方を1にする
6. csvを保存する
7. 6で保存したcsvを2個複製する
8. 複製したファイル名をfile2、file3に書き換える
9. changelistset_file1～3の3つのファイルをコピーする
10. 同フォルダ内にある「1」「2」のフォルダの内、「2」を開く
11. 「already」「cash」フォルダがあることを確認する
12. 「already」「cash」フォルダ内『ではなく』、同階層にコピーしたファイルを貼り付ける
13. 「cash」フォルダ内のcsvの更新時刻が変わったら再計算手続きの完了

## 注意事項

- restartフォルダは触らないこと
- ファイルの配置場所を間違えないよう注意（alreadyやcashフォルダ内ではなく、同階層に配置）
- file1～file3の3つのファイルが必要
- 再計算と書き換えは目的に応じて使い分ける