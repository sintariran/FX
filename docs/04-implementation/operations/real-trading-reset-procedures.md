# リアルの再設定手続き

FXシステムのリアル取引環境再設定手順（取得データ/リアルの再設定手続.xlsxより）

## 概要

プロセスは3つ：
1. 設定ファイルの置き換え
2. 設定ファイルの変換処理
3. アイドリング

## A1. 設定ファイルの置き換え

### B1. 下準備

#### C1. 古いファイルのバックアップ1
1. hostop-rd1フォルダに入る
2. settingfilesフォルダに入る
3. 「1」と「2」というフォルダのうち、「1」に入る
4. bkupフォルダに入る
5. 既存のフォルダを参考にして現在日時を使ってフォルダを作る
6. ひとつ前のフォルダに戻る
7. bkupフォルダとcashフォルダ以外のフォルダをコピーする
8. 5で作ったフォルダにコピーしたものを貼り付ける
9. 「1」と「2」というフォルダのうち、「2」に入る
10. 「1」フォルダでした4から9を「2」でも行う

#### C2. 古いファイルのバックアップ2
1. hostop-rd1フォルダに入る
2. bkup_MTXフォルダに入る
3. 「1」と「2」というフォルダのうち、「1」に入る
4. bkupフォルダに入る
5. 既存のフォルダを参考にして現在日時を使ってフォルダを作る
6. ひとつ前のフォルダに戻る
7. splitというフレーズの入ったフォルダをコピーする
8. 5で作ったフォルダにコピーしたものを貼り付ける
9. 「1」と「2」というフォルダのうち、「2」に入る
10. 「1」フォルダでした4から9を「2」でも行う

### B2. 本手続
1. 実行ファイルを開く
2. リアル用設定ファイル出力のブロックへ移動する
3. パラ処理区切り区分に下の文字列を入力する
   - `1/1.1/15/30/100/200`
4. パラ処理数を3にする
5. 出力開始ボタンを押す
6. finishを確認する(目安:ボタンをおしてから60分から90分程度)
7. 91サーバー内30_settingフォルダへ移動
8. 20_configフォルダへ移動
9. 出力されているフォルダをすべてコピーする
10. hostop-rd1フォルダに入る
11. settingfilesフォルダに入る
12. 「1」と「2」フォルダの内、「1」フォルダに入る
13. 9でコピーしたものを貼り付ける
14. ファイル名フォルダに入る
15. 1_1_設定ファイル数フォルダに入る
16. config.csvを開く
17. 数字を控えておく(例:249,だったとする)
18. settingfilesフォルダに戻る
19. 1_1_seting_group_patter_list.csvを開く
20. 末端行の数字を確認する
21. 17で控えた数字との比較をする
22. 以下のルールで1_1_seting_group_patter_list.csvの行を加工する
    - 数字が一致する場合はなにもしない
    - 1_1_seting_group_patter_list.csvの数字の方が少ないならドラッグして一致させる
    - 1_1_seting_group_patter_list.csvの数字の方が多いなら17以上の数字が出ている行は削除する
23. 「1」「2」の内、「2」のフォルダに「1」の内容をコピーする

## A2. 設定ファイルの変換処理

### B1. 週頭に使う3サーバーを開く
注意：20210318時点では、214と11サーバーで作業をしているのでこのタイミングでは138は開かなくてもよい

### B2. 214について
1. スタートアップのFXDDの内、一番右にあるものを開く

### B3. 11について
1. スタートアップのFXDDの内、一番右にあるものを開く
2. スタートアップのFXDDの内、FXPROの左にあるものを開く

### B4. 手続き完了の確認をする
1. FXDD画面のエキスパートを選択
2. 右クリックする
3. 開くを選択する
4. ログを開く
5. 次のフレーズを確認する
6. `outputbackupmtdata,end`
7. 上のフレーズが出てきた場合、行先頭の時刻を確認する
8. 時刻がB2B3をしたあとの時刻であることを確認する
9. 6から8が満たされていれば手続きは完了している

### B5～B10. バックアップ処理
5. B2B3で開いたFXDD画面を閉じる
6. hostop-rd1フォルダに入る
7. bkup_MTXフォルダに入る
8. 「1」と「2」フォルダの内、「1」フォルダに入る
9. 全てのデータをコピーする
10. 「1」と「2」フォルダの内、「2」フォルダに貼り付ける

## A3. アイドリング

1. 週頭の3つのサーバーに入る
2. 週頭に同期させているFXDDを閉じる
3. hostop-rd1フォルダに入る
4. operationSignalフォルダに入る
5. traceフォルダに入る
6. 「1」と「2」のうち、「1」のフォルダを"_"を使って名前を変える
7. 週頭と同じように同時起動させる
8. FXDD起動時のポップアップは必ず残しておく
9. 同期の確認
   - 同時起動に失敗した場合はポップアップに英語でない文字列が出てくる
   - 出てこずに「合致」というフレーズがエキスパート上に出てくれば成功
10. 別のサーバーのでも同様のことをする
11. 別の3つのサーバーに入る
12. 同期させているFXDDを閉じる
13. hostop-rd1フォルダに入る
14. operationSignalフォルダに入る
15. traceフォルダに入る
16. 「1」と「2」のうち、「2」のフォルダを"_"を使って名前を変える
17. 以降7～9を行う
18. アイドリング完了の確認
    - ポップアップアラートにindicatordownloaderrorという文字がでてきたら完了

## 注意事項

- バックアップは必ず実施すること
- フォルダ名の変更には"_"（アンダースコア）を使用
- 同期確認で「合致」が出ない場合は再度実施
- indicatordownloaderrorが出るまで待つ