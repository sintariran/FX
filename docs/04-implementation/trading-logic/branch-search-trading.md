# 分岐探索取引システム

FXシステムの分岐探索取引に関する設定（10_分岐探索_取引.xlsmより）

## 概要

分岐探索取引システムは、複数の条件分岐を使用して取引シグナルを生成します。各時間足で参照するPKGのルートIDを指定し、様々な状況に応じた取引判断を行います。

## シート構成

### 基本分岐
- 通常基本用分岐
- 通常基本決済用分岐

### 追加エントリー分岐
- 追加上用分岐
- 追加下用分岐
- 強追加上用分岐
- 強追加下用分岐
- カウンター追加上用分岐
- カウンター追加下用分岐
- 突発カウンター追加上用分岐
- 突発カウンター追加下用分岐
- 超々加速追加上用分岐
- 超々加速追加下用分岐

### ヘッジ分岐
- ヘッジ上用分岐
- ヘッジ下用分岐
- ヘッジ決済上用分岐
- ヘッジ決済下用分岐
- ヘッジ突発上用分岐
- ヘッジ突発下用分岐

### 決済分岐
- 追加決済上用分岐
- 追加決済下用分岐
- 強追加決済上用分岐
- 強追加決済下用分岐
- 突発追加決済用分岐
- カウンター追加決済用分岐
- 突発カウンター追加決済用分岐
- 超々加速追加決済用分岐

### その他の分岐
- 180行帰用分岐
- テスト用分岐
- 共通上用分岐/共通下用分岐
- 共通C上用分岐/共通C下用分岐
- レンジ上用分岐/レンジ下用分岐
- 接続判断用分岐
- まとめ取引信号上用分岐/まとめ取引信号下用分岐
- OP方向の派生用分岐
- OP全体構成用分岐
- 多段転換判断用分岐
- パラボ転換用分岐
- 他通貨フォロー用分岐
- 超々加速基本用分岐/超々加速基本決済用分岐/超々加速追加用分岐

## 主要な分岐条件

### OP信号関連
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| OP信号トリガーあり | 1/2 | 0 | OP信号がトリガーされた場合 |
| OP信号トリガーなし | 3 | 0 | OP信号がトリガーされない場合 |
| OPFF信号トリガーあり | 1/2 | 0 | OPFF信号がトリガーされた場合 |
| OPFF信号トリガーなし | 3 | 0 | OPFF信号がトリガーされない場合 |
| OPF信号トリガーあり | 1/2 | 0 | OPF信号がトリガーされた場合 |
| OPF信号トリガーなし | 3 | 0 | OPF信号がトリガーされない場合 |

### 180Os関連
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| 180Os行き | 1 | 0 | 180分足Os指標の上昇方向 |
| 180Os帰り | 2 | 0 | 180分足Os指標の下降方向 |

### 待機状態
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| 待機 | 3 | 1 | 取引待機状態 |
| 待機（保持） | 3 | 5 | ポジション保持中の待機状態 |

### 方向一致判定
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| OP信号と前足OP信号と方向一致 | 1 | 0 | 現在と前足のOP信号方向が一致 |
| OP信号と前足OP信号と方向不一致 | 2 | 0 | 現在と前足のOP信号方向が不一致 |
| OP信号と240分足行き帰り方向が一致 | 1 | 0 | OP信号と240分足の方向が一致 |
| OP信号と240分足行き帰り方向が不一致 | 2 | 0 | OP信号と240分足の方向が不一致 |

### エントリー条件
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| 追加エントリー | 1/2 | 1 | 追加ポジションのエントリー条件 |
| ヘッジエントリー | 1/2 | 1 | ヘッジポジションのエントリー条件 |
| 突発順方向エントリー | 1/2 | 1 | 突発的な順方向エントリー |
| 突発逆方向エントリー | 1/2 | 1 | 突発的な逆方向エントリー |

### トップ範囲判定
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| トップ範囲に入っている_対240分足 | 1 | 0 | 240分足でトップ範囲内 |
| トップ範囲に入ってない_対240分足 | 2 | 0 | 240分足でトップ範囲外 |
| トップ範囲に入っている_対60分足 | 1 | 0 | 60分足でトップ範囲内 |
| トップ範囲に入ってない_対60分足 | 2 | 0 | 60分足でトップ範囲外 |
| トップ範囲に入っている_対15分足 | 1 | 0 | 15分足でトップ範囲内 |
| トップ範囲に入ってない_対15分足 | 2 | 0 | 15分足でトップ範囲外 |

### もみ抜け判定
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| もみ抜けあり確定v3 | 1/2 | 1 | もみ合い抜けが確定 |
| もみ抜けありv3 | 1/2 | 0 | もみ合い抜けが発生 |
| もみ抜け方向と先足もみ抜け方向が一致 | 1 | 0 | 現在と先足のもみ抜け方向が一致 |
| もみ抜け方向と先足もみ抜け方向が不一致 | 2 | 0 | 現在と先足のもみ抜け方向が不一致 |

### 突発条件
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| 長期ポーションを除いた突発上が発生 | 1 | 0 | 上方向への突発的な動き |
| 長期ポーションを除いた突発下が発生 | 2 | 0 | 下方向への突発的な動き |
| 長期ポーションを除いた突発が発生しない | 3 | 0 | 突発的な動きなし |

### 多段転換判定
| 分岐名 | 参照ステート | ルートタイプ | 説明 |
|--------|--------------|--------------|------|
| OP信号と240分足多段転換方向の一致 | 1 | 0 | 240分足での多段転換方向が一致 |
| OP信号と240分足多段転換方向の不一致 | 2 | 0 | 240分足での多段転換方向が不一致 |
| OP信号と60分足多段転換方向の一致 | 1 | 0 | 60分足での多段転換方向が一致 |
| OP信号と60分足多段転換方向の不一致 | 2 | 0 | 60分足での多段転換方向が不一致 |
| OP信号と15分足多段転換方向の一致 | 1 | 0 | 15分足での多段転換方向が一致 |
| OP信号と15分足多段転換方向の不一致 | 2 | 0 | 15分足での多段転換方向が不一致 |

## ルートタイプの定義

- 0: 通常ルート
- 1: 末端ルート
- 2: 状況ルート
- 3: 再帰ルート
- 4: 計算待機ルート
- 5: 保持ルート
- 8: 親階層探索終了ルート

## 時間足の定義

システムは以下の時間足を使用します：
- 1分足
- 5分足
- 15分足
- 30分足
- 60分足
- 240分足

前足がない場合（前足がない場合1-5）と先足がない場合（先足がない場合1-5）の処理も定義されています。