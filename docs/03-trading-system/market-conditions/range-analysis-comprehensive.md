# レンジ分析システム総合ガイド

## 📋 概要

FX取引システムにおけるレンジ分析の包括的なガイドです。3つの基本レンジタイプを中心とした分析手法と、実際の取引での活用方法を体系的に整理しています。

## 🎯 基本レンジタイプ

### 1. 足レンジ
- **定義**: 各時間足における足の価格範囲
- **用途**: 短期的な価格変動の境界判定
- **決済条件**: 足レンジ抜け
- **もみ対応**: 足レンジに価格が入ってから逆についた時の対応

### 2. 価格レンジ（Pレンジ）
- **定義**: サポート・レジスタンスレベルの特定
- **用途**: 重要な価格水準での反転・ブレイクアウト判定
- **決済条件**: Pレンジ抜け
- **戦略**: 上下限での取引戦略

### 3. 時間レンジ
- **定義**: 時間軸による相場形成範囲
- **用途**: 長期的なトレンド継続・転換の判定
- **特徴**: 最も大きな分析単位

### 階層構造
```
時間レンジ（最大）
  ├── 価格レンジ（中間）
  └── 足レンジ（最小）
```

## 📊 特殊レンジ指標

### 90-180レンジ
- **指標ID**: 28
- **分類**: Common（共通）
- **機能**: 90分足と180分足の周期を基準としたレンジ判定
- **転換回数**: 295/48/21/8/4/4（各時間足）

### 180レンジ上下
- **パッケージID**: ID655916-ID655918
- **機能**: 180分足でのレンジ上下判定
- **用途**: 長期時間軸でのレンジ境界特定

## 🔧 レンジ判定システム

### 残距離判定
#### 上レンジ残距離
- **条件**: 上レンジ残距離が3pips未満
- **パッケージID**: ID653990-ID653991
- **管理**: パターン1と3

#### 下レンジ残距離
- **条件**: 下レンジ残距離が3pips未満
- **パッケージID**: ID653992-ID653993
- **管理**: パターン1と3

### レンジ幅判定
- **基準**: レンジ幅5pips未満
- **用途**: 狭小レンジの識別
- **応用**: エントリー制限の判定

### 価格レンジ判定
#### 内外判定
- **パッケージID**: ID655570-ID655572
- **機能**: 現在価格のレンジ内外判定
- **パターン**: 3つのパターンで管理

#### 保持レンジ判定
- **上下判定**: ID656701-ID656703
- **内外判定**: ID656704, ID656706
- **収束判定**: ID656707-ID656709（大小考慮）

## 🌊 もみ相場分析

### もみ状態の定義
1. **基本もみ**: 平均足の方向が一定でない状態
2. **横ばいもみ**: 動きが横ばいの状態
3. **内包もみ**: より大きな時間足でのもみ状態

### もみ判定条件
1. **前足の加速変化**: 減速または逆加速の成立
2. **ふり幅**: 前足のふり幅が小さい
3. **方向性**: 平均足の方向が不安定

### もみ状態の分類
#### 規模による分類
- **大きいもみ**: 上位時間足での価格停滞
  - 条件: 接続維持、線の上下維持
- **小さいもみ**: 下位時間足での価格停滞

#### 状態による分類
1. **通常もみ状態**
2. **全もみ状態**
3. **収束もみ状態**

### もみ抜け判定
#### 判定条件
- Mac上 Os上転換
- Mac上 Os下増転換
- Ot増転換

## 🎯 取引戦略

### エントリー戦略
#### レンジ内取引
1. **レンジ境界への接近確認**
2. **方向性フィルターの適用**
3. **残足状態の確認**
4. **Os同期の確認**

#### レンジブレイクアウト
1. **ブレイクアウト方向のフォロー**
2. **フォルスブレイクアウトの回避**
3. **適切なエントリータイミング**

### 決済戦略
#### 基本決済条件
1. **平均足転換**
2. **足レンジ抜け**
3. **Pレンジ抜け**

#### レンジ内処理
- レンジエントリー後の上端接触決済
- レンジ価格交点の保持（上下分離）

### リスク管理
1. **レンジブレイクへの対応**
2. **フォルスブレイクアウトの識別**
3. **適切なストップロス設定**

## 📈 監視パラメータ

### 主要監視項目
- **価格レンジ上下無**
- **収束レンジ中外**
- **収束レンジ抜け方向上下**
- **前足価格レンジ上下無**
- **前足収束レンジ中外**
- **前足収束レンジ抜け方向上下**

### レンジ周期指標
- **レンジ上周期**: 転換回数 2291/451/153/72/39/18
- **レンジ下周期**: 転換回数 2291/462/149/73/41/20

## ⚠️ 注意事項・制限事項

### 技術的制限
1. **計算負荷**: リアルタイム処理での負荷考慮
2. **精度**: フォルスブレイクアウト識別の精度向上
3. **整合性**: 異なる時間軸間での判定結果の整合性

### 運用上の注意
1. **5pips閾値**: レンジ幅5pips未満の理論的根拠要確認
2. **更新タイミング**: 保持レンジの更新タイミング明確化
3. **優先順位**: 複数もみ状態同時発生時の処理

## 🔄 システム統合

### 他システムとの連携
1. **Os系指標**: レンジ判定での補完
2. **TSML周期**: 各周期でのレンジ分析
3. **分岐探索**: パッケージベースでの条件管理

### データフロー
```
価格データ → レンジ判定 → もみ分析 → エントリー判定 → 決済判定
                ↓
            リスク管理 ← ポジション管理
```

---

最終更新日：2025年1月4日