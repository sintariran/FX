# トップ絞り込み

## 📋 概要

トップ絞り込みは、転換点の出し方を体系化し、Mac・Osの増減確認と周期分析を通じて、精密なトップ（転換点）の特定を行う手法です。平均足の転換によるトップ成立時刻の特定と、もみ状態を考慮した判定により、高精度な転換点分析を実現します。

## 🎯 転換点の出し方

### 基本的な転換点判定
1. **Macの増減の確認**
2. **Osの増減の確認**
3. **更新となる場合、短期周期のMac増減とOs増減が合致している**

## 📊 周期別パラメータ（参考値）

### 各周期の設定値
```
10: CA117, SU077, BA117, SU063
30: CA115, SU081, BA115, SU059	
90: CA112, SU087, BA112, SU053
180: CA111, SU091, BA111, SU051
```

### システム実装上の注意点
- **253,254がT周期になってる**
- **256が10行目を参照しているが1列ずれている**

## 📈 トップ成立の分析

### 平均足転換によるトップ
**平均足の転換によるトップの成立時刻を出す**

### 周期別トップ数の確認
**各周期に対応するトップが何本成立しているかを確認する**

## 🔍 先足転換の考慮

### もみ考慮を含む先足転換
**先足転換（もみ考慮）**の判定要素：
- T周期残足
- S周期残足
- もみ抜け判定

## 🌊 もみ状態でのトップ判定

### 転換確定条件
**転換確定（先足転換足、もみ以外）**：
- オペレーションステート成立

### もみ抜けの判定
**もみ抜け（もみ抜け方向転換）**：
- Mac上 Os上転換
- Mac上 Os下増転換
- Ot増転換

### もみ状態の定義
**もみ状態**: Mac上Os下Ot増

## 📊 トップ絞り込みの実践

### 段階的な絞り込み
1. **第一段階**: Mac・Os増減の基本確認
2. **第二段階**: 短期周期との合致確認
3. **第三段階**: もみ状態の考慮
4. **最終段階**: 複数条件での総合判定

### 時間軸別の処理
- **短期（10分）**: 高頻度だが信頼性は中程度
- **中期（30分）**: バランスの良い判定
- **長期（90分、180分）**: 低頻度だが高信頼性

## 🎯 絞り込み条件の最適化

### 基本条件
1. **Mac増減とOs増減の合致**
2. **周期間の整合性**
3. **もみ状態の適切な処理**

### 追加条件
1. **残足状態の確認**
2. **オペレーションステートの成立**
3. **他時間軸との同期**

## 📈 トップの質的評価

### 強いトップの特徴
1. **複数周期での同時成立**
2. **Mac・Os完全合致**
3. **もみ抜け後の成立**

### 弱いトップの特徴
1. **単一周期のみの成立**
2. **Mac・Os部分合致**
3. **もみ中での成立**

## 🔧 システム実装の改善点

### データ参照の修正
- **列ズレの修正**（256行目）
- **T周期の正確な設定**（253,254行目）

### 処理効率の向上
1. **リアルタイム計算の最適化**
2. **不要な再計算の削減**
3. **メモリ使用量の最小化**

## 💡 トップ絞り込みの応用

### 複合判定
1. **他の指標との組み合わせ**
2. **市場環境別の調整**
3. **通貨ペア特性の反映**

### 予測精度の向上
1. **過去データの統計分析**
2. **パターン認識の活用**
3. **機械学習による最適化**

## 📊 統計的検証

### バックテスト項目
1. **絞り込み精度の測定**
2. **誤判定率の分析**
3. **収益性への貢献度**

### 改善指標
1. **的中率の向上**
2. **早期発見率の改善**
3. **ノイズ除去率の向上**

---

## 📅 出典
- **ファイル**: 20200420_トップ絞り込み.txt（2020年4月20日）
- **ファイル**: 20200423_TOP絞込.txt（2020年4月23日）
- **カテゴリ**: 取引システム・テクニカル指標